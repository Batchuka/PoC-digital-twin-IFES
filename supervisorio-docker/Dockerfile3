# FROM ubuntu:latest
FROM amazoncorretto:17
# Define a imagem base do OS como o OpenJDK 22 slim-bullseye

RUN yum update -y && yum install unzip -y

# Executa o comando "apt-get update" para atualizar os repositórios de pacotes
# Instala o pacote "unzip" usando o "apt-get install" com a opção "-y" para confirmar automaticamente

RUN mkdir -p /root
# Cria um diretório chamado "/root" usando o comando "mkdir -p"

ENV mango_paths_home /root
# Define uma variável de ambiente chamada "mango_paths_home" com o valor "/root"

# RUN useradd --system --home-dir /root --shell /bin/false mango
# Cria um usuário chamado "mango" com o diretório home definido como "/root"
# Define o shell do usuário como "/bin/false" para impedir o login do usuário

COPY free-m2m2-core-5.0.2.zip /tmp/
# Copia o arquivo "enterprise-m2m2-core-4.0.0.zip" para o diretório "/tmp/" dentro do contêiner

RUN unzip /tmp/free-m2m2-core-5.0.2.zip -d /root \
    # && chown -R mango:mango /root \
    && rm /tmp/free-m2m2-core-5.0.2.zip
# Descompacta o arquivo zip "free-m2m2-core-5.0.2.zip" para o diretório "/root"
# Define as permissões do diretório "/root" para o usuário "mango"
# Remove o arquivo zip "/tmp/free-m2m2-core-5.0.2.zip"

# COPY mango.properties /root/mango.properties
# # Copia o arquivo "mango.properties" para o diretório "/root/mango.properties" dentro do contêiner

# COPY start-options.sh /root/bin/start-options.sh
# # Copia o arquivo "start-options.sh" para o diretório "/root/bin/start-options.sh" dentro do contêiner

WORKDIR /root
# Define o diretório de trabalho como "/root"

# USER mango
# Define o usuário "mango" como o usuário padrão para execução do contêiner

EXPOSE 8080

ENTRYPOINT ["bin/start-mango.sh"]
# Define o comando a ser executado quando o contêiner for iniciado: "bin/start-mango.sh"
